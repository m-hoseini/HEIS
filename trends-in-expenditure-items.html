<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Trends in expenditure items | Household Expenditure and Income Surveys of Iran</title>
  <meta name="description" content="The Household Expenditure and Income Surveys of Iran: Introduction and data cleaning" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Trends in expenditure items | Household Expenditure and Income Surveys of Iran" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The Household Expenditure and Income Surveys of Iran: Introduction and data cleaning" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Trends in expenditure items | Household Expenditure and Income Surveys of Iran" />
  
  <meta name="twitter:description" content="The Household Expenditure and Income Surveys of Iran: Introduction and data cleaning" />
  

<meta name="author" content="Mohammad Hoseini and Avenia Ghazarian" />


<meta name="date" content="2020-12-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cleaning-data.html"/>
<link rel="next" href="some-applications-of-household-level-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#sample-design"><i class="fa fa-check"></i><b>1.1</b> Sample design</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#rotating-panel-feature"><i class="fa fa-check"></i><b>1.1.1</b> Rotating panel feature</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#different-rounds"><i class="fa fa-check"></i><b>1.2</b> Different rounds</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="questionnaire-details.html"><a href="questionnaire-details.html"><i class="fa fa-check"></i><b>2</b> Questionnaire details</a><ul>
<li class="chapter" data-level="2.1" data-path="questionnaire-details.html"><a href="questionnaire-details.html#part-1---member-characteristics"><i class="fa fa-check"></i><b>2.1</b> Part 1 - Member Characteristics</a></li>
<li class="chapter" data-level="2.2" data-path="questionnaire-details.html"><a href="questionnaire-details.html#part-2---household-facilities"><i class="fa fa-check"></i><b>2.2</b> Part 2 - Household Facilities</a></li>
<li class="chapter" data-level="2.3" data-path="questionnaire-details.html"><a href="questionnaire-details.html#part-3---expenditure"><i class="fa fa-check"></i><b>2.3</b> Part 3 - Expenditure</a></li>
<li class="chapter" data-level="2.4" data-path="questionnaire-details.html"><a href="questionnaire-details.html#part-4-income"><i class="fa fa-check"></i><b>2.4</b> Part 4: Income</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="importing-raw-data.html"><a href="importing-raw-data.html"><i class="fa fa-check"></i><b>3</b> Importing raw data</a><ul>
<li class="chapter" data-level="3.1" data-path="importing-raw-data.html"><a href="importing-raw-data.html#importing-access-files-to-r"><i class="fa fa-check"></i><b>3.1</b> Importing access files to R</a></li>
<li class="chapter" data-level="3.2" data-path="importing-raw-data.html"><a href="importing-raw-data.html#importing-code-for-all-years"><i class="fa fa-check"></i><b>3.2</b> Importing code for all years</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cleaning-data.html"><a href="cleaning-data.html"><i class="fa fa-check"></i><b>4</b> Cleaning data</a><ul>
<li class="chapter" data-level="4.1" data-path="cleaning-data.html"><a href="cleaning-data.html#importing-raw-data-and-sampling-information"><i class="fa fa-check"></i><b>4.1</b> Importing raw data and sampling information</a></li>
<li class="chapter" data-level="4.2" data-path="cleaning-data.html"><a href="cleaning-data.html#cleaning-part-1"><i class="fa fa-check"></i><b>4.2</b> Cleaning Part 1</a></li>
<li class="chapter" data-level="4.3" data-path="cleaning-data.html"><a href="cleaning-data.html#cleaning-part-2"><i class="fa fa-check"></i><b>4.3</b> Cleaning Part 2</a></li>
<li class="chapter" data-level="4.4" data-path="cleaning-data.html"><a href="cleaning-data.html#cleaning-part-3"><i class="fa fa-check"></i><b>4.4</b> Cleaning Part 3</a><ul>
<li class="chapter" data-level="4.4.1" data-path="cleaning-data.html"><a href="cleaning-data.html#price-index-and-real-expenditure"><i class="fa fa-check"></i><b>4.4.1</b> Price index and real expenditure</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="cleaning-data.html"><a href="cleaning-data.html#cleaning-part-4"><i class="fa fa-check"></i><b>4.5</b> Cleaning Part 4</a></li>
<li class="chapter" data-level="4.6" data-path="cleaning-data.html"><a href="cleaning-data.html#building-item-level-data"><i class="fa fa-check"></i><b>4.6</b> Building item-level data</a></li>
<li class="chapter" data-level="4.7" data-path="cleaning-data.html"><a href="cleaning-data.html#building-individual-level-data"><i class="fa fa-check"></i><b>4.7</b> Building individual-level data</a></li>
<li class="chapter" data-level="4.8" data-path="cleaning-data.html"><a href="cleaning-data.html#building-household-level-data-summary-files"><i class="fa fa-check"></i><b>4.8</b> Building Household-level data (summary files)</a><ul>
<li class="chapter" data-level="4.8.1" data-path="cleaning-data.html"><a href="cleaning-data.html#exporting-to-other-formats."><i class="fa fa-check"></i><b>4.8.1</b> Exporting to other formats.</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="cleaning-data.html"><a href="cleaning-data.html#special-issues-for-different-years"><i class="fa fa-check"></i><b>4.9</b> Special issues for different years</a><ul>
<li class="chapter" data-level="4.9.1" data-path="cleaning-data.html"><a href="cleaning-data.html#the-structure-of-address-variable"><i class="fa fa-check"></i><b>4.9.1</b> The structure of Address variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="trends-in-expenditure-items.html"><a href="trends-in-expenditure-items.html"><i class="fa fa-check"></i><b>5</b> Trends in expenditure items</a><ul>
<li class="chapter" data-level="5.1" data-path="trends-in-expenditure-items.html"><a href="trends-in-expenditure-items.html#total-expenditure-across-coicop-groups"><i class="fa fa-check"></i><b>5.1</b> Total expenditure across COICOP groups</a></li>
<li class="chapter" data-level="5.2" data-path="trends-in-expenditure-items.html"><a href="trends-in-expenditure-items.html#expenditure-shares-of-coicop-groups"><i class="fa fa-check"></i><b>5.2</b> Expenditure shares of COICOP groups</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="some-applications-of-household-level-data.html"><a href="some-applications-of-household-level-data.html"><i class="fa fa-check"></i><b>6</b> Some applications of household-level data</a><ul>
<li class="chapter" data-level="6.1" data-path="some-applications-of-household-level-data.html"><a href="some-applications-of-household-level-data.html#gas-price-reform-in-november-2019-in-iran-and-poverty"><i class="fa fa-check"></i><b>6.1</b> Gas price reform in November 2019 in Iran and poverty</a></li>
<li class="chapter" data-level="6.2" data-path="some-applications-of-household-level-data.html"><a href="some-applications-of-household-level-data.html#car-ownership-across-provinces"><i class="fa fa-check"></i><b>6.2</b> Car ownership across provinces</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Household Expenditure and Income Surveys of Iran</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="trends-in-expenditure-items" class="section level1">
<h1><span class="header-section-number">5</span> Trends in expenditure items</h1>
<style type="text/css">
pre {
  max-height: 500px;
  overflow-y: auto;
}

pre[class] {
  max-height: 500px;
}
</style>
<p>In this section we present some trends using the cleaned data of expenditure items.</p>
<div id="total-expenditure-across-coicop-groups" class="section level2">
<h2><span class="header-section-number">5.1</span> Total expenditure across COICOP groups</h2>
<p>Here is a piece of code showing the trend of expenditure items in real term:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="trends-in-expenditure-items.html#cb1-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="trends-in-expenditure-items.html#cb1-2"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span>
<span id="cb1-3"><a href="trends-in-expenditure-items.html#cb1-3"></a></span>
<span id="cb1-4"><a href="trends-in-expenditure-items.html#cb1-4"></a>list_EXP &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;exported&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;^EXP.*</span><span class="ch">\\</span><span class="st">Rds$&quot;</span>)</span>
<span id="cb1-5"><a href="trends-in-expenditure-items.html#cb1-5"></a></span>
<span id="cb1-6"><a href="trends-in-expenditure-items.html#cb1-6"></a><span class="co">## merging different rounds</span></span>
<span id="cb1-7"><a href="trends-in-expenditure-items.html#cb1-7"></a>EXP &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb1-8"><a href="trends-in-expenditure-items.html#cb1-8"></a><span class="cf">for</span> (year <span class="cf">in</span> list_EXP) {</span>
<span id="cb1-9"><a href="trends-in-expenditure-items.html#cb1-9"></a>  EXP &lt;-<span class="st"> </span><span class="kw">assign</span>(year, <span class="kw">readRDS</span>(<span class="kw">paste0</span>(<span class="st">&quot;exported/&quot;</span>,year))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-10"><a href="trends-in-expenditure-items.html#cb1-10"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">parse_number</span>(year)) <span class="op">%&gt;%</span></span>
<span id="cb1-11"><a href="trends-in-expenditure-items.html#cb1-11"></a><span class="st">    </span><span class="kw">bind_rows</span>(EXP)</span>
<span id="cb1-12"><a href="trends-in-expenditure-items.html#cb1-12"></a>}</span>
<span id="cb1-13"><a href="trends-in-expenditure-items.html#cb1-13"></a></span>
<span id="cb1-14"><a href="trends-in-expenditure-items.html#cb1-14"></a>exp &lt;-<span class="st"> </span>EXP <span class="op">%&gt;%</span></span>
<span id="cb1-15"><a href="trends-in-expenditure-items.html#cb1-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Table =</span> <span class="kw">as_factor</span>(<span class="kw">case_when</span>(</span>
<span id="cb1-16"><a href="trends-in-expenditure-items.html#cb1-16"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;food&quot;</span>,</span>
<span id="cb1-17"><a href="trends-in-expenditure-items.html#cb1-17"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &quot;clothing&quot;</span>,</span>
<span id="cb1-18"><a href="trends-in-expenditure-items.html#cb1-18"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> &quot;housing&quot;</span>,</span>
<span id="cb1-19"><a href="trends-in-expenditure-items.html#cb1-19"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">6</span> <span class="op">~</span><span class="st"> &quot;health&quot;</span>,</span>
<span id="cb1-20"><a href="trends-in-expenditure-items.html#cb1-20"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">7</span> <span class="op">~</span><span class="st"> &quot;transport&quot;</span>,</span>
<span id="cb1-21"><a href="trends-in-expenditure-items.html#cb1-21"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">8</span> <span class="op">~</span><span class="st"> &quot;communication&quot;</span>,</span>
<span id="cb1-22"><a href="trends-in-expenditure-items.html#cb1-22"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">9</span> <span class="op">|</span><span class="st"> </span>table <span class="op">==</span><span class="st"> </span><span class="dv">11</span> <span class="op">~</span><span class="st"> &quot;recreation &amp; restaurant&quot;</span>,</span>
<span id="cb1-23"><a href="trends-in-expenditure-items.html#cb1-23"></a>    table <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">2</span>) <span class="op">~</span><span class="st"> &quot;miscellaneous &amp; tobacco&quot;</span>,</span>
<span id="cb1-24"><a href="trends-in-expenditure-items.html#cb1-24"></a>    table <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">13</span> , <span class="dv">5</span>) <span class="op">~</span><span class="st"> &quot;durables &amp; furniture&quot;</span>,</span>
<span id="cb1-25"><a href="trends-in-expenditure-items.html#cb1-25"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">14</span> <span class="op">~</span><span class="st"> &quot;investment&quot;</span>,</span>
<span id="cb1-26"><a href="trends-in-expenditure-items.html#cb1-26"></a>    <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA_character_</span>))) <span class="op">%&gt;%</span></span>
<span id="cb1-27"><a href="trends-in-expenditure-items.html#cb1-27"></a><span class="st">  </span><span class="kw">group_by</span>(Table, year) <span class="op">%&gt;%</span></span>
<span id="cb1-28"><a href="trends-in-expenditure-items.html#cb1-28"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">value_r=</span><span class="kw">sum</span>(Value_r,<span class="dt">na.rm =</span> T), <span class="dt">value=</span><span class="kw">sum</span>(Value,<span class="dt">na.rm =</span> T)) </span>
<span id="cb1-29"><a href="trends-in-expenditure-items.html#cb1-29"></a></span>
<span id="cb1-30"><a href="trends-in-expenditure-items.html#cb1-30"></a><span class="kw">ggplot</span>(exp, <span class="kw">aes</span>(<span class="dt">x=</span>year, <span class="dt">y=</span><span class="kw">log</span>(value_r), <span class="dt">color=</span>Table, <span class="dt">shape=</span>Table)) <span class="op">+</span></span>
<span id="cb1-31"><a href="trends-in-expenditure-items.html#cb1-31"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb1-32"><a href="trends-in-expenditure-items.html#cb1-32"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Total real expenditure (log)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb1-33"><a href="trends-in-expenditure-items.html#cb1-33"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="figures/total.png" /></p>
</div>
<div id="expenditure-shares-of-coicop-groups" class="section level2">
<h2><span class="header-section-number">5.2</span> Expenditure shares of COICOP groups</h2>
<p>The below code shows the change in the share of each expenditure item:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="trends-in-expenditure-items.html#cb2-1"></a>exp &lt;-<span class="st"> </span>exp <span class="op">%&gt;%</span></span>
<span id="cb2-2"><a href="trends-in-expenditure-items.html#cb2-2"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb2-3"><a href="trends-in-expenditure-items.html#cb2-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">share=</span><span class="kw">round</span>(value<span class="op">/</span><span class="kw">sum</span>(value)<span class="op">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span>
<span id="cb2-4"><a href="trends-in-expenditure-items.html#cb2-4"></a></span>
<span id="cb2-5"><a href="trends-in-expenditure-items.html#cb2-5"></a><span class="kw">ggplot</span>(exp, <span class="kw">aes</span>(<span class="dt">x=</span>year, <span class="dt">y=</span>share, <span class="dt">fill=</span>Table, <span class="dt">label =</span> share)) <span class="op">+</span></span>
<span id="cb2-6"><a href="trends-in-expenditure-items.html#cb2-6"></a><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></span>
<span id="cb2-7"><a href="trends-in-expenditure-items.html#cb2-7"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">position =</span> <span class="kw">position_stack</span>(<span class="dt">vjust =</span> <span class="fl">.5</span>), <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb2-8"><a href="trends-in-expenditure-items.html#cb2-8"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Share of expenditure items&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb2-9"><a href="trends-in-expenditure-items.html#cb2-9"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="figures/share.png" />
## Percapita expenditure across COICOP groups and regions</p>
<p>In the next step, we graph the trend of percapita expenditure of each item for the rural and urban areas. For this, we need the population of each round and we use household-level summary data for that:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="trends-in-expenditure-items.html#cb3-1"></a>list_HH &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;exported&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;^HH.*</span><span class="ch">\\</span><span class="st">Rds$&quot;</span>)</span>
<span id="cb3-2"><a href="trends-in-expenditure-items.html#cb3-2"></a></span>
<span id="cb3-3"><a href="trends-in-expenditure-items.html#cb3-3"></a><span class="co">## number of households and individuals across years</span></span>
<span id="cb3-4"><a href="trends-in-expenditure-items.html#cb3-4"></a>Pop &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb3-5"><a href="trends-in-expenditure-items.html#cb3-5"></a><span class="cf">for</span> (year <span class="cf">in</span> list_HH) {</span>
<span id="cb3-6"><a href="trends-in-expenditure-items.html#cb3-6"></a>  Pop &lt;-<span class="st"> </span><span class="kw">assign</span>(year, <span class="kw">readRDS</span>(<span class="kw">paste0</span>(<span class="st">&quot;exported/&quot;</span>,year))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-7"><a href="trends-in-expenditure-items.html#cb3-7"></a><span class="st">    </span><span class="kw">group_by</span>(urban) <span class="op">%&gt;%</span></span>
<span id="cb3-8"><a href="trends-in-expenditure-items.html#cb3-8"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">hh=</span><span class="kw">sum</span>(weight, <span class="dt">na.rm=</span>T), <span class="dt">ind=</span><span class="kw">sum</span>(size<span class="op">*</span>weight, <span class="dt">na.rm=</span>T)) <span class="op">%&gt;%</span></span>
<span id="cb3-9"><a href="trends-in-expenditure-items.html#cb3-9"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">parse_number</span>(year)) <span class="op">%&gt;%</span></span>
<span id="cb3-10"><a href="trends-in-expenditure-items.html#cb3-10"></a><span class="st">    </span><span class="kw">bind_rows</span>(Pop)</span>
<span id="cb3-11"><a href="trends-in-expenditure-items.html#cb3-11"></a>  <span class="kw">rm</span>(year)</span>
<span id="cb3-12"><a href="trends-in-expenditure-items.html#cb3-12"></a>}</span>
<span id="cb3-13"><a href="trends-in-expenditure-items.html#cb3-13"></a></span>
<span id="cb3-14"><a href="trends-in-expenditure-items.html#cb3-14"></a>exp &lt;-<span class="st"> </span>EXP <span class="op">%&gt;%</span></span>
<span id="cb3-15"><a href="trends-in-expenditure-items.html#cb3-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Table =</span> <span class="kw">as_factor</span>(<span class="kw">case_when</span>(</span>
<span id="cb3-16"><a href="trends-in-expenditure-items.html#cb3-16"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;food&quot;</span>,</span>
<span id="cb3-17"><a href="trends-in-expenditure-items.html#cb3-17"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &quot;tobacco&quot;</span>,</span>
<span id="cb3-18"><a href="trends-in-expenditure-items.html#cb3-18"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &quot;clothing&quot;</span>,</span>
<span id="cb3-19"><a href="trends-in-expenditure-items.html#cb3-19"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> &quot;housing&quot;</span>,</span>
<span id="cb3-20"><a href="trends-in-expenditure-items.html#cb3-20"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">5</span> <span class="op">~</span><span class="st"> &quot;furniture&quot;</span>,</span>
<span id="cb3-21"><a href="trends-in-expenditure-items.html#cb3-21"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">6</span> <span class="op">~</span><span class="st"> &quot;health&quot;</span>,</span>
<span id="cb3-22"><a href="trends-in-expenditure-items.html#cb3-22"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">7</span> <span class="op">~</span><span class="st"> &quot;transport&quot;</span>,</span>
<span id="cb3-23"><a href="trends-in-expenditure-items.html#cb3-23"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">8</span> <span class="op">~</span><span class="st"> &quot;communication&quot;</span>,</span>
<span id="cb3-24"><a href="trends-in-expenditure-items.html#cb3-24"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">9</span> <span class="op">|</span><span class="st"> </span>table <span class="op">==</span><span class="st"> </span><span class="dv">11</span> <span class="op">~</span><span class="st"> &quot;recreation </span><span class="ch">\n</span><span class="st"> restaurant&quot;</span>,</span>
<span id="cb3-25"><a href="trends-in-expenditure-items.html#cb3-25"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">12</span> <span class="op">~</span><span class="st"> &quot;miscellaneous&quot;</span>,</span>
<span id="cb3-26"><a href="trends-in-expenditure-items.html#cb3-26"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">13</span> <span class="op">~</span><span class="st"> &quot;durables&quot;</span>,</span>
<span id="cb3-27"><a href="trends-in-expenditure-items.html#cb3-27"></a>    table <span class="op">==</span><span class="st"> </span><span class="dv">14</span> <span class="op">~</span><span class="st"> &quot;investment&quot;</span>,</span>
<span id="cb3-28"><a href="trends-in-expenditure-items.html#cb3-28"></a>    <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA_character_</span>))) <span class="op">%&gt;%</span></span>
<span id="cb3-29"><a href="trends-in-expenditure-items.html#cb3-29"></a><span class="st">  </span><span class="kw">group_by</span>(Table, year,urban) <span class="op">%&gt;%</span></span>
<span id="cb3-30"><a href="trends-in-expenditure-items.html#cb3-30"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">value_r=</span><span class="kw">sum</span>(Value_r,<span class="dt">na.rm =</span> T), <span class="dt">value=</span><span class="kw">sum</span>(Value,<span class="dt">na.rm =</span> T)) <span class="op">%&gt;%</span></span>
<span id="cb3-31"><a href="trends-in-expenditure-items.html#cb3-31"></a><span class="st">  </span><span class="kw">left_join</span>(Pop) <span class="op">%&gt;%</span></span>
<span id="cb3-32"><a href="trends-in-expenditure-items.html#cb3-32"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value_r_ph=</span>value_r<span class="op">/</span>ind)</span>
<span id="cb3-33"><a href="trends-in-expenditure-items.html#cb3-33"></a></span>
<span id="cb3-34"><a href="trends-in-expenditure-items.html#cb3-34"></a><span class="kw">ggplot</span>(exp, <span class="kw">aes</span>(<span class="dt">x=</span>year, <span class="dt">y=</span><span class="kw">log</span>(value_r_ph), <span class="dt">color=</span>urban, <span class="dt">shape=</span>urban)) <span class="op">+</span></span>
<span id="cb3-35"><a href="trends-in-expenditure-items.html#cb3-35"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb3-36"><a href="trends-in-expenditure-items.html#cb3-36"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Table, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-37"><a href="trends-in-expenditure-items.html#cb3-37"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Real per capita expenditure (log)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb3-38"><a href="trends-in-expenditure-items.html#cb3-38"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="figures/percapita.png" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cleaning-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="some-applications-of-household-level-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
