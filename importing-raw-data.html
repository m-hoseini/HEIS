<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Importing raw data | Household Expenditure and Income Surveys of Iran</title>
  <meta name="description" content="The Household Expenditure and Income Surveys of Iran: Introduction and data cleaning" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Importing raw data | Household Expenditure and Income Surveys of Iran" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The Household Expenditure and Income Surveys of Iran: Introduction and data cleaning" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Importing raw data | Household Expenditure and Income Surveys of Iran" />
  
  <meta name="twitter:description" content="The Household Expenditure and Income Surveys of Iran: Introduction and data cleaning" />
  

<meta name="author" content="Mohammad Hoseini and Avenia Ghazarian" />


<meta name="date" content="2020-11-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="questionnaire-details.html"/>
<link rel="next" href="cleaning-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#sample-design"><i class="fa fa-check"></i><b>1.1</b> Sample design</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#rotating-panel-feature"><i class="fa fa-check"></i><b>1.1.1</b> Rotating panel feature</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#different-rounds"><i class="fa fa-check"></i><b>1.2</b> Different rounds</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="questionnaire-details.html"><a href="questionnaire-details.html"><i class="fa fa-check"></i><b>2</b> Questionnaire details</a><ul>
<li class="chapter" data-level="2.1" data-path="questionnaire-details.html"><a href="questionnaire-details.html#part-1---member-characteristics"><i class="fa fa-check"></i><b>2.1</b> Part 1 - Member Characteristics</a></li>
<li class="chapter" data-level="2.2" data-path="questionnaire-details.html"><a href="questionnaire-details.html#part-2---household-facilities"><i class="fa fa-check"></i><b>2.2</b> Part 2 - Household Facilities</a></li>
<li class="chapter" data-level="2.3" data-path="questionnaire-details.html"><a href="questionnaire-details.html#part-3---expenditure"><i class="fa fa-check"></i><b>2.3</b> Part 3 - Expenditure</a></li>
<li class="chapter" data-level="2.4" data-path="questionnaire-details.html"><a href="questionnaire-details.html#part-4-income"><i class="fa fa-check"></i><b>2.4</b> Part 4: Income</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="importing-raw-data.html"><a href="importing-raw-data.html"><i class="fa fa-check"></i><b>3</b> Importing raw data</a><ul>
<li class="chapter" data-level="3.1" data-path="importing-raw-data.html"><a href="importing-raw-data.html#importing-access-files-to-r"><i class="fa fa-check"></i><b>3.1</b> Importing access files to R</a></li>
<li class="chapter" data-level="3.2" data-path="importing-raw-data.html"><a href="importing-raw-data.html#importing-code-for-all-years"><i class="fa fa-check"></i><b>3.2</b> Importing code for all years</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cleaning-data.html"><a href="cleaning-data.html"><i class="fa fa-check"></i><b>4</b> Cleaning data</a><ul>
<li class="chapter" data-level="4.1" data-path="cleaning-data.html"><a href="cleaning-data.html#importing-raw-data-and-sampling-information"><i class="fa fa-check"></i><b>4.1</b> Importing raw data and sampling information</a></li>
<li class="chapter" data-level="4.2" data-path="cleaning-data.html"><a href="cleaning-data.html#cleaning-part-1"><i class="fa fa-check"></i><b>4.2</b> Cleaning Part 1</a></li>
<li class="chapter" data-level="4.3" data-path="cleaning-data.html"><a href="cleaning-data.html#cleaning-part-2"><i class="fa fa-check"></i><b>4.3</b> Cleaning Part 2</a></li>
<li class="chapter" data-level="4.4" data-path="cleaning-data.html"><a href="cleaning-data.html#cleaning-part-3"><i class="fa fa-check"></i><b>4.4</b> Cleaning Part 3</a><ul>
<li class="chapter" data-level="4.4.1" data-path="cleaning-data.html"><a href="cleaning-data.html#price-index-and-real-expenditure"><i class="fa fa-check"></i><b>4.4.1</b> Price index and real expenditure</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="cleaning-data.html"><a href="cleaning-data.html#cleaning-part-4"><i class="fa fa-check"></i><b>4.5</b> Cleaning Part 4</a></li>
<li class="chapter" data-level="4.6" data-path="cleaning-data.html"><a href="cleaning-data.html#building-item-level-data"><i class="fa fa-check"></i><b>4.6</b> Building item-level data</a></li>
<li class="chapter" data-level="4.7" data-path="cleaning-data.html"><a href="cleaning-data.html#building-individual-level-data"><i class="fa fa-check"></i><b>4.7</b> Building individual-level data</a></li>
<li class="chapter" data-level="4.8" data-path="cleaning-data.html"><a href="cleaning-data.html#building-household-level-data-summary-files"><i class="fa fa-check"></i><b>4.8</b> Building Household-level data (summary files)</a><ul>
<li class="chapter" data-level="4.8.1" data-path="cleaning-data.html"><a href="cleaning-data.html#exporting-to-other-formats."><i class="fa fa-check"></i><b>4.8.1</b> Exporting to other formats.</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="cleaning-data.html"><a href="cleaning-data.html#special-issues-for-different-years"><i class="fa fa-check"></i><b>4.9</b> Special issues for different years</a><ul>
<li class="chapter" data-level="4.9.1" data-path="cleaning-data.html"><a href="cleaning-data.html#the-structure-of-address-variable"><i class="fa fa-check"></i><b>4.9.1</b> The structure of Address variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="price-adjustment-and-appending.html"><a href="price-adjustment-and-appending.html"><i class="fa fa-check"></i><b>5</b> Price adjustment and appending</a><ul>
<li class="chapter" data-level="5.1" data-path="price-adjustment-and-appending.html"><a href="price-adjustment-and-appending.html#price-adjustment"><i class="fa fa-check"></i><b>5.1</b> Price Adjustment</a></li>
<li class="chapter" data-level="5.2" data-path="price-adjustment-and-appending.html"><a href="price-adjustment-and-appending.html#merging-individual-level-data-overtime"><i class="fa fa-check"></i><b>5.2</b> Merging individual level data overtime</a></li>
<li class="chapter" data-level="5.3" data-path="price-adjustment-and-appending.html"><a href="price-adjustment-and-appending.html#merging-household-level-data-over-time"><i class="fa fa-check"></i><b>5.3</b> Merging household-level data over time</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="overall-trends.html"><a href="overall-trends.html"><i class="fa fa-check"></i><b>6</b> Overall trends</a><ul>
<li class="chapter" data-level="6.1" data-path="overall-trends.html"><a href="overall-trends.html#gas-price-reform-in-november-2019-in-iran-and-poverty"><i class="fa fa-check"></i><b>6.1</b> Gas price reform in November 2019 in Iran and poverty</a></li>
<li class="chapter" data-level="6.2" data-path="overall-trends.html"><a href="overall-trends.html#car-ownership-across-provinces"><i class="fa fa-check"></i><b>6.2</b> Car ownership across provinces</a></li>
<li class="chapter" data-level="6.3" data-path="overall-trends.html"><a href="overall-trends.html#trends-in-expenditure-items"><i class="fa fa-check"></i><b>6.3</b> Trends in expenditure items</a></li>
<li class="chapter" data-level="6.4" data-path="overall-trends.html"><a href="overall-trends.html#trends-of-individual-level-data"><i class="fa fa-check"></i><b>6.4</b> Trends of individual level data</a></li>
<li class="chapter" data-level="6.5" data-path="overall-trends.html"><a href="overall-trends.html#trends-of-household-level-data-over-time"><i class="fa fa-check"></i><b>6.5</b> Trends of household-level data over time</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Household Expenditure and Income Surveys of Iran</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="importing-raw-data" class="section level1">
<h1><span class="header-section-number">3</span> Importing raw data</h1>
<style type="text/css">
pre {
  max-height: 500px;
  overflow-y: auto;
}

pre[class] {
  max-height: 500px;
}
</style>
<p>The raw data of HEIS is available at: <a href="https://bit.ly/3a9BTI0" class="uri">https://bit.ly/3a9BTI0</a> (accessed 23-3-2020). For documentation, we explain the details regarding the importing process in this chapter, but readers uninterested on the details of importing can skip the rest of this chapter and download our converted R version of the raw files (in <em>.rdata</em> format) here: <a href="https://bit.ly/3hxwsqh" class="uri">https://bit.ly/3hxwsqh</a></p>
<p>The raw data files of SCI include a <em>.mdb</em> data file and a questionnaire. The first step is to import the data file into <em>R</em>. This require an <em>R</em> package called “RODBC”. We also need “tidyverse” and “data.table” packages later and if any of them are not installed on your platform you can install by <code>install.packages()</code> function.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">install.packages</span>(RODBC)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">install.packages</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">install.packages</span>(data.table)</a></code></pre></div>
<div id="importing-access-files-to-r" class="section level2">
<h2><span class="header-section-number">3.1</span> Importing access files to R</h2>
<p>With the RODBC packaged the <em>.mdb</em> files can be imported using the following sample code for the 1397 survey. Note than the below code will only work with 32-bit versions of the Microsoft drivers and are not usable on 64-bit version. If you have a 64-bit R and get error with the below code, see this stack-exchange post: <a href="https://stackoverflow.com/questions/13070706/how-to-connect-r-with-access-database-in-64-bit-window" class="uri">https://stackoverflow.com/questions/13070706/how-to-connect-r-with-access-database-in-64-bit-window</a></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(RODBC) <span class="co"># load package</span></a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3">db &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="st">&quot;F:/Data/HEIS/97/Data97.mdb&quot;</span>) <span class="co"># File path to be changed based on the location of data-files</span></a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5">channel&lt;-<span class="kw">odbcConnectAccess2007</span>(db) <span class="co">#internal RODBC function</span></a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7">names &lt;-<span class="kw">subset</span>(<span class="kw">sqlTables</span>(channel),TABLE_TYPE <span class="op">==</span><span class="st"> &quot;TABLE&quot;</span>, TABLE_NAME)[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> names) {</a>
<a class="sourceLine" id="cb2-10" title="10">  <span class="kw">print</span>(i)</a>
<a class="sourceLine" id="cb2-11" title="11">  nam &lt;-<span class="st"> </span><span class="kw">paste</span>(i)</a>
<a class="sourceLine" id="cb2-12" title="12">  <span class="kw">assign</span>(nam, <span class="kw">sqlFetch</span>(channel,i))</a>
<a class="sourceLine" id="cb2-13" title="13">}</a>
<a class="sourceLine" id="cb2-14" title="14"></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="kw">rm</span>(<span class="st">&quot;channel&quot;</span>,<span class="st">&quot;i&quot;</span>, <span class="st">&quot;nam&quot;</span>, <span class="st">&quot;names&quot;</span>,<span class="st">&quot;db&quot;</span>)</a>
<a class="sourceLine" id="cb2-16" title="16"></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="kw">save.image</span>(<span class="dt">file=</span><span class="kw">paste0</span>(<span class="st">&quot;F:/Data/HEIS/97.RData&quot;</span>))</a></code></pre></div>
</div>
<div id="importing-code-for-all-years" class="section level2">
<h2><span class="header-section-number">3.2</span> Importing code for all years</h2>
<p>The below code is written to import the access files of all years and merge them with the summary files provided separately by SCI. Note that for year 1389 and 1390 the access files are provided in <em>.accdb</em> format. The SCI published the summary files up to 1395. As the format of summary files are changing between <em>.dbf, .xls</em>, and <em>.xlsx</em> formats, we need to include packages “foreign” and “readxl” too.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(RODBC) <span class="co"># load packages</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">library</span>(foreign) </a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">63</span><span class="op">:</span><span class="dv">95</span>) {</a>
<a class="sourceLine" id="cb3-6" title="6"></a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="cf">if</span> (j<span class="op">==</span><span class="dv">89</span><span class="op">|</span>j<span class="op">==</span><span class="dv">90</span>) {</a>
<a class="sourceLine" id="cb3-8" title="8">    db &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">paste0</span>(<span class="st">&quot;F:/Data/HBS/&quot;</span>,j,<span class="st">&quot;/Data-&quot;</span>,j,<span class="st">&quot;/Data&quot;</span>,j,<span class="st">&quot;.accdb&quot;</span>) )</a>
<a class="sourceLine" id="cb3-9" title="9">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb3-10" title="10">    db &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">paste0</span>(<span class="st">&quot;F:/Data/HBS/&quot;</span>,j,<span class="st">&quot;/Data-&quot;</span>,j,<span class="st">&quot;/Data&quot;</span>,j) )</a>
<a class="sourceLine" id="cb3-11" title="11">  }</a>
<a class="sourceLine" id="cb3-12" title="12"></a>
<a class="sourceLine" id="cb3-13" title="13">channel&lt;-<span class="kw">odbcConnectAccess2007</span>(db) <span class="co">#internal RODBC function</span></a>
<a class="sourceLine" id="cb3-14" title="14"></a>
<a class="sourceLine" id="cb3-15" title="15">names &lt;-<span class="kw">subset</span>(<span class="kw">sqlTables</span>(channel),TABLE_TYPE <span class="op">==</span><span class="st"> &quot;TABLE&quot;</span>, TABLE_NAME)[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb3-16" title="16"></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="cf">for</span> (i <span class="cf">in</span> names) {</a>
<a class="sourceLine" id="cb3-18" title="18">  <span class="kw">print</span>(i)</a>
<a class="sourceLine" id="cb3-19" title="19">  nam &lt;-<span class="st"> </span><span class="kw">paste</span>(i)</a>
<a class="sourceLine" id="cb3-20" title="20">  <span class="kw">assign</span>(nam, <span class="kw">sqlFetch</span>(channel,i))</a>
<a class="sourceLine" id="cb3-21" title="21">}</a>
<a class="sourceLine" id="cb3-22" title="22"></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="kw">rm</span>(<span class="st">&quot;channel&quot;</span>,<span class="st">&quot;i&quot;</span>, <span class="st">&quot;nam&quot;</span>, <span class="st">&quot;names&quot;</span>,<span class="st">&quot;db&quot;</span>)</a>
<a class="sourceLine" id="cb3-24" title="24"></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="kw">save.image</span>(<span class="dt">file=</span><span class="kw">paste0</span>(<span class="st">&quot;F:/Data/HBS/r/raw&quot;</span>,j,<span class="st">&quot;.RData&quot;</span>))</a>
<a class="sourceLine" id="cb3-26" title="26"></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="kw">print</span>(j)</a>
<a class="sourceLine" id="cb3-28" title="28"></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb3-30" title="30">}</a>
<a class="sourceLine" id="cb3-31" title="31"></a>
<a class="sourceLine" id="cb3-32" title="32"></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="co">## merging summary files</span></a>
<a class="sourceLine" id="cb3-34" title="34"></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">63</span><span class="op">:</span><span class="dv">75</span>) {</a>
<a class="sourceLine" id="cb3-36" title="36">  </a>
<a class="sourceLine" id="cb3-37" title="37">  <span class="kw">assign</span>(<span class="kw">paste0</span>(<span class="st">&quot;Sum_R&quot;</span>,j), <span class="kw">read.dbf</span>(<span class="kw">paste0</span>(<span class="st">&quot;F:/Data/HBS/Summeries/63-75/R&quot;</span>,j,<span class="st">&quot;_SUM.dbf&quot;</span>)))</a>
<a class="sourceLine" id="cb3-38" title="38">  <span class="kw">assign</span>(<span class="kw">paste0</span>(<span class="st">&quot;Sum_U&quot;</span>,j), <span class="kw">read.dbf</span>(<span class="kw">paste0</span>(<span class="st">&quot;F:/Data/HBS/Summeries/63-75/U&quot;</span>,j,<span class="st">&quot;_SUM.dbf&quot;</span>)))</a>
<a class="sourceLine" id="cb3-39" title="39">  </a>
<a class="sourceLine" id="cb3-40" title="40">  <span class="kw">load</span>(<span class="kw">paste0</span>(<span class="st">&quot;F:/DATA/HBS/r/raw&quot;</span>,j,<span class="st">&quot;.rdata&quot;</span>)) </a>
<a class="sourceLine" id="cb3-41" title="41">  </a>
<a class="sourceLine" id="cb3-42" title="42">  <span class="kw">save.image</span>(<span class="dt">file=</span><span class="kw">paste0</span>(<span class="st">&quot;F:/Data/HBS/r/&quot;</span>,j,<span class="st">&quot;.RData&quot;</span>))</a>
<a class="sourceLine" id="cb3-43" title="43">  </a>
<a class="sourceLine" id="cb3-44" title="44">  <span class="kw">print</span>(j)</a>
<a class="sourceLine" id="cb3-45" title="45">  </a>
<a class="sourceLine" id="cb3-46" title="46">  <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb3-47" title="47">}</a>
<a class="sourceLine" id="cb3-48" title="48"></a>
<a class="sourceLine" id="cb3-49" title="49"><span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">rbind</span>(<span class="dv">76</span><span class="op">:</span><span class="dv">87</span>,<span class="dv">93</span>,<span class="dv">95</span>)) {</a>
<a class="sourceLine" id="cb3-50" title="50">  </a>
<a class="sourceLine" id="cb3-51" title="51">  <span class="kw">assign</span>(<span class="kw">paste0</span>(<span class="st">&quot;Sum_R&quot;</span>,j), <span class="kw">read_xls</span>(<span class="kw">paste0</span>(<span class="st">&quot;F:/Data/HBS/Summeries/sum_&quot;</span>,j,<span class="st">&quot;/W_SUM_R&quot;</span>,j,<span class="st">&quot;.xls&quot;</span>)))</a>
<a class="sourceLine" id="cb3-52" title="52">  <span class="kw">assign</span>(<span class="kw">paste0</span>(<span class="st">&quot;Sum_U&quot;</span>,j), <span class="kw">read_xls</span>(<span class="kw">paste0</span>(<span class="st">&quot;F:/Data/HBS/Summeries/sum_&quot;</span>,j,<span class="st">&quot;/W_SUM_U&quot;</span>,j,<span class="st">&quot;.xls&quot;</span>)))</a>
<a class="sourceLine" id="cb3-53" title="53">  </a>
<a class="sourceLine" id="cb3-54" title="54">  <span class="kw">load</span>(<span class="kw">paste0</span>(<span class="st">&quot;F:/DATA/HBS/r/raw&quot;</span>,j,<span class="st">&quot;.rdata&quot;</span>)) </a>
<a class="sourceLine" id="cb3-55" title="55">  </a>
<a class="sourceLine" id="cb3-56" title="56">  <span class="kw">save.image</span>(<span class="dt">file=</span><span class="kw">paste0</span>(<span class="st">&quot;F:/Data/HBS/r/&quot;</span>,j,<span class="st">&quot;.RData&quot;</span>))</a>
<a class="sourceLine" id="cb3-57" title="57">  </a>
<a class="sourceLine" id="cb3-58" title="58">  <span class="kw">print</span>(j)</a>
<a class="sourceLine" id="cb3-59" title="59">  </a>
<a class="sourceLine" id="cb3-60" title="60">  <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb3-61" title="61">}</a>
<a class="sourceLine" id="cb3-62" title="62"></a>
<a class="sourceLine" id="cb3-63" title="63"><span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">rbind</span>(<span class="dv">88</span><span class="op">:</span><span class="dv">92</span>,<span class="dv">94</span>)) {</a>
<a class="sourceLine" id="cb3-64" title="64">  </a>
<a class="sourceLine" id="cb3-65" title="65">  <span class="kw">assign</span>(<span class="kw">paste0</span>(<span class="st">&quot;Sum_R&quot;</span>,j), <span class="kw">read_xlsx</span>(<span class="kw">paste0</span>(<span class="st">&quot;F:/Data/HBS/Summeries/sum_&quot;</span>,j,<span class="st">&quot;/W_SUM_R&quot;</span>,j,<span class="st">&quot;.xlsx&quot;</span>)))</a>
<a class="sourceLine" id="cb3-66" title="66">  <span class="kw">assign</span>(<span class="kw">paste0</span>(<span class="st">&quot;Sum_U&quot;</span>,j), <span class="kw">read_xlsx</span>(<span class="kw">paste0</span>(<span class="st">&quot;F:/Data/HBS/Summeries/sum_&quot;</span>,j,<span class="st">&quot;/W_SUM_U&quot;</span>,j,<span class="st">&quot;.xlsx&quot;</span>)))</a>
<a class="sourceLine" id="cb3-67" title="67">  </a>
<a class="sourceLine" id="cb3-68" title="68">  <span class="kw">load</span>(<span class="kw">paste0</span>(<span class="st">&quot;F:/DATA/HBS/r/raw&quot;</span>,j,<span class="st">&quot;.rdata&quot;</span>)) </a>
<a class="sourceLine" id="cb3-69" title="69">  </a>
<a class="sourceLine" id="cb3-70" title="70">  <span class="kw">save.image</span>(<span class="dt">file=</span><span class="kw">paste0</span>(<span class="st">&quot;F:/Data/HBS/r/&quot;</span>,j,<span class="st">&quot;.RData&quot;</span>))</a>
<a class="sourceLine" id="cb3-71" title="71">  </a>
<a class="sourceLine" id="cb3-72" title="72">  <span class="kw">print</span>(j)</a>
<a class="sourceLine" id="cb3-73" title="73">  </a>
<a class="sourceLine" id="cb3-74" title="74">  <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb3-75" title="75">}</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="questionnaire-details.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cleaning-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
